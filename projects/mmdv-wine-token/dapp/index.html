<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>MWT5 – MMDV Wine Token - Proyecto Educativo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Estilos globales MMDV Blockchain -->
  <link rel="stylesheet" href="/MMDV-Blockchain/assets/style.css" />

  <!-- Estilo extra específico de la dApp (opcional) -->
  <link rel="stylesheet" href="./style.css" />

</head>
<body class="page-dark">

  <!-- HERO / CABECERA -->
  <section class="hero">
    <div class="wrap">
      <div class="row">
        <div>
          <h1>MWT5 – MMDV Wine Token - Proyecto Educativo</h1>
          <p>
            Token ERC-20 educativo que representa un <strong>lote de vino tokenizado</strong> en la red Sepolia.
            Aquí puedes ver las <strong>reglas inteligentes</strong> del contrato, simular escenarios y,
            si conectas tu wallet, interactuar on-chain.
          </p>
        </div>
        <nav>
          <a href="/MMDV-Blockchain/index.html">Inicio</a>
          <a href="/MMDV-Blockchain/projects/index.html">Proyectos</a>
          <a href="/MMDV-Blockchain/projects/mmdv-wine-token/index.html">MWT</a>
          <button id="connectButton" class="btn btn-primary">
            Conectar wallet
          </button>
        </nav>
      </div>
    </div>
  </section>

  <main class="wrap main-grid">

    <!-- COLUMNA IZQUIERDA: CONTEXTO Y REGLAS -->
    <section class="card card--glass">
      <h2>Contexto del lote MWT5</h2>
      <p>
        <strong>MWT5</strong> es un token ERC-20 educativo que simula la tokenización de un lote de vino.
        Cada token representa <strong>1 unidad simbólica de vino</strong> (botella o participación).
      </p>
      <p>
        El contrato está desplegado en <strong>Sepolia</strong> y programado con reglas de negocio
        que imitan cómo podría gestionarse un lote real: bloqueos temporales, precio mínimo creciente,
        recompra del owner y bonus por fidelidad.
      </p>

      <h3>Reglas educativas del contrato</h3>
      <ul class="list">
        <li><strong>Valor simbólico inicial:</strong> 10 unidades internas por token (no euros on-chain).</li>
        <li><strong>Periodo de cancelación:</strong> primeras 24h posibilidad de desistimiento (modelo educativo).</li>
        <li><strong>Período de bloqueo:</strong> durante un tiempo mínimo los tokens no pueden transferirse.</li>
        <li><strong>Precio mínimo de reventa:</strong> el valor teórico aumenta con el tiempo de holdeado.</li>
        <li><strong>Bonus por antigüedad:</strong> após 4 años se calcula un 10% teórico extra.</li>
        <li><strong>Opción de recompra:</strong> el owner puede recomprar tokens según unas reglas pactadas.</li>
        <li><strong>Prioridad en futuros lotes:</strong> los holders quedan marcados con prioridad educativa.</li>
      </ul>

      <p class="note">
        ⚠️ <strong>Aviso:</strong> Todo esto es un <strong>proyecto didáctico</strong>. No representa una oferta
        real de inversión ni un valor financiero. Sirve para aprender cómo las reglas se codifican en un
        <em>smart contract</em>.
      </p>
    </section>

    <!-- COLUMNA DERECHA: ESTADO ON-CHAIN -->
    <section class="card card--glass">
      <h2>Estado del lote en blockchain</h2>

      <div class="grid grid-2">
        <div>
          <p class="label">Dirección del contrato</p>
          <p id="contractAddress" class="mono small"></p>
        </div>
        <div>
          <p class="label">Red</p>
          <p class="mono small">Sepolia Testnet</p>
        </div>
        <div>
          <p class="label">Token</p>
          <p><span id="tokenName">…</span> (<span id="tokenSymbol">…</span>)</p>
        </div>
        <div>
          <p class="label">Decimales</p>
          <p><span id="tokenDecimals">0</span></p>
        </div>
        <div>
          <p class="label">Supply actual</p>
          <p><span id="totalSupply">…</span> / <span id="maxSupply">…</span> MWT5</p>
        </div>
        <div>
          <p class="label">Cuenta conectada</p>
          <p id="currentAccount" class="mono small">No conectada</p>
        </div>
      </div>

      <hr />

      <h3>Balance por dirección</h3>
      <form id="balanceForm" class="form-inline">
        <input
          id="balanceAddress"
          type="text"
          class="input mono"
          placeholder="0x… dirección a consultar"
        />
        <button class="btn btn-ghost" type="submit">Consultar balance</button>
      </form>
      <p id="balanceResult" class="mono small muted"></p>
    </section>

    <!-- FILA 2: SIMULADOR + PANEL WEB3 -->
    <section class="card card--glass">
      <h2>Simulador de valor educativo</h2>
      <p>
        Usa el tiempo de holdeado para estimar un <strong>multiplicador teórico</strong> y un posible
        bonus de fidelidad.
      </p>

      <form id="simulatorForm" class="form-grid">
        <div>
          <label for="simTokens">Tokens MWT5 (unidades)</label>
          <input id="simTokens" type="number" min="1" value="100" class="input" />
        </div>
        <div>
          <label for="simYears">Años holdeando</label>
          <input id="simYears" type="number" min="0" max="10" step="1" value="2" class="input" />
        </div>
        <div>
          <label for="simBasePrice">Valor simbólico inicial (unidades)</label>
          <input id="simBasePrice" type="number" min="1" value="10" class="input" />
        </div>
        <div class="align-end">
          <button type="submit" class="btn btn-primary">Calcular escenario</button>
        </div>
      </form>

      <div id="simulatorOutput" class="sim-output">
        <!-- Rellenado por JS -->
      </div>
    </section>

    <section class="card card--glass">
      <h2>Panel Web3 (modo dApp)</h2>
      <p>
        Cuando conectes tu wallet en Sepolia, podrás realizar operaciones reales sobre el contrato:
        transferencias, pruebas de recompra, etc. Mientras tanto, este panel queda en modo lectura.
      </p>

      <div id="web3Status" class="status status--disconnected">
        <strong>Estado:</strong> wallet no conectada.
      </div>

      <div class="panel-actions disabled" id="web3Panel">
        <h3>Acciones básicas</h3>
        <form id="transferForm" class="form-grid">
          <div>
            <label for="transferTo">Enviar a (address)</label>
            <input id="transferTo" class="input mono" placeholder="0x… destino" />
          </div>
          <div>
            <label for="transferAmount">Cantidad (MWT5)</label>
            <input id="transferAmount" class="input" type="number" min="1" />
          </div>
          <div class="align-end">
            <button type="submit" class="btn btn-primary">Enviar tokens</button>
          </div>
        </form>

        <hr />

        <h3>Acciones educativas (owner)</h3>
        <p class="small muted">
          Estas acciones solo funcionarán si la cuenta conectada es el <strong>owner</strong> del contrato.
        </p>
        <div class="btn-row">
          <button id="ownerBuybackButton" class="btn btn-ghost" disabled>
            Simular recompra owner
          </button>
          <button id="earlyCancelButton" class="btn btn-ghost" disabled>
            Simular cancelación 24h
          </button>
        </div>
      </div>

      <p class="note small">
        ℹ️ En este primer paso, el panel Web3 está preparado a nivel de interfaz.
        Las llamadas de escritura (recompra, cancelación) las conectamos justo después,
        usando exactamente las funciones del contrato V5.
      </p>
    </section>

  </main>

  <footer class="footer">
    <div class="wrap footer-inner">
      <p class="small">
        MWT5 – MMDV Wine Token · Proyecto educativo de tokenización de vino · MMDV-Blockchain
      </p>
    </div>
  </footer>

  <!-- Web3 + lógica de la dApp -->
  <script src="https://cdn.jsdelivr.net/npm/web3@1.10.0/dist/web3.min.js"></script>
  <script src="./app.js"></script>
</body>
</html>

